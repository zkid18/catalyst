


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Callbacks &mdash; Catalyst 21.03.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Contrib" href="contrib.html" />
    <link rel="prev" title="Config API" href="../faq/config_api.html" /> 

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-167094275-1"></script>
  <script src="../_static/js/googleanalytics.min.js"></script>
  
  <script src="../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://catalyst-team.com/" aria-label="Catalyst"></a>

      <div class="main-menu">
        <ul>

          <li>
            <div class="ecosystem-dropdown">
              <a id="dropdownMenuButtonEcosystem" data-toggle="ecosystem-dropdown">
                Ecosystem
              </a>
              <div class="ecosystem-dropdown-menu">
                <a class="nav-dropdown-item" href="https://alchemy.host">
                  <span class=dropdown-title>Alchemy</span>
                  <p>Experiments logging & visualization</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/catalyst">
                  <span class=dropdown-title>Catalyst</span>
                  <p>Accelerated deep learning R&D</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/reaction">
                  <span class=dropdown-title>Reaction</span>
                  <p>Convenient deep learning models serving</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <div class="projects-dropdown">
              <a id="dropdownMenuButtonProjects" data-toggle="projects-dropdown">
                Projects
              </a>
              <div class="projects-dropdown-menu">
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/codestyle">
                  <span class=dropdown-title>Codestyle</span>
                  <p>Joint R&D codestyle</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/neuro">
                  <span class=dropdown-title>Catalyst.Neuro</span>
                  <p>Catalyst.Team and TReNDS collaborative project</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/classification">
                  <span class=dropdown-title>Classification</span>
                  <p>Image classification pipeline with transfer learning</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/detection">
                  <span class=dropdown-title>Detection</span>
                  <p>Object detection pipeline</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/segmentation">
                  <span class=dropdown-title>Segmentation</span>
                  <p>Image semantic segmentation pipeline</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/gan">
                  <span class=dropdown-title>Catalyst.GAN</span>
                  <p>GAN pipelines</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/catalyst-team/dl-course">Deep learning course</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="catalyst-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="catalyst-left-menu" id="catalyst-left-menu">
      <div class="catalyst-side-scroll">
        <div class="catalyst-menu catalyst-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="catalyst-left-menu-search">
            

            
              
              
                <div class="version">
                  <a href="https://catalyst-team.github.io/catalyst/versions.html">21.03</a>
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Catalyst</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quickstart.html">Quickstart 101</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst#minimal-examples">Minimal examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/migrating_from_other.html">Migrating from other libraries</a></li>
<li class="toctree-l1"><a class="reference external" href="https://medium.com/pytorch/catalyst-101-accelerated-pytorch-bd766a556d92?source=friends_link&amp;sk=d3dd9b2b23500eca046361187b4619ff">Catalyst 101 — Accelerated PyTorch</a></li>
<li class="toctree-l1"><a class="reference external" href="https://medium.com/pytorch/catalyst-102-core-trinity-experiment-runner-and-callback-54adc384b57c?source=friends_link&amp;sk=2aff824412e2f653587a30cd853b030c">Catalyst 102 — Core Trinity</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ddp.html">Distributed training tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Core</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core/runner.html">Runner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/engine.html">Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/callback.html">Callback</a></li>
</ul>
<p class="caption"><span class="caption-text">FAQ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/intro.html">How to make X?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/data.html">Dataflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/dp.html">DataParallel training (cpu, single/multi-gpu)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/amp.html">Mixed precision training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/ddp.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/multi_components.html">Multiple components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/early_stopping.html">Early stopping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/checkpointing.html">Model checkpointing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/debugging.html">Model debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/optuna.html">Optuna integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/finetuning.html">Finetuning (multistage runs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/config_api.html">Config API</a></li>
</ul>
<p class="caption"><span class="caption-text">Contribution guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst/blob/master/CONTRIBUTING.md">How to start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/codestyle">Codestyle</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst#acknowledgments">Acknowledgments</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">Contrib</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="engines.html">Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="loggers.html">Loggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="runners.html">Runners</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="catalyst-container">
      <div class="catalyst-page-level-bar" id="catalyst-page-level-bar">
        <div class="catalyst-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="catalyst-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Callbacks</li>
    
    
      <li class="catalyst-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/catalyst-team/catalyst/blob/master/docs/api/callbacks.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="catalyst-shortcuts-wrapper" id="catalyst-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="catalyst-content-wrap" class="catalyst-content-wrap">
        <div class="catalyst-content-left">
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="catalyst-article" class="catalyst-article">
              
  <div class="section" id="callbacks">
<h1>Callbacks<a class="headerlink" href="#callbacks" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#module-catalyst.callbacks" id="id1">Run</a></p>
<ul>
<li><p><a class="reference internal" href="#batchoverfitcallback" id="id2">BatchOverfitCallback</a></p></li>
<li><p><a class="reference internal" href="#batchtransformcallback" id="id3">BatchTransformCallback</a></p></li>
<li><p><a class="reference internal" href="#checkpointcallback" id="id4">CheckpointCallback</a></p></li>
<li><p><a class="reference internal" href="#controlflowcallback" id="id5">ControlFlowCallback</a></p></li>
<li><p><a class="reference internal" href="#criterioncallback" id="id6">CriterionCallback</a></p></li>
<li><p><a class="reference internal" href="#metric-batchmetriccallback" id="id7">Metric – BatchMetricCallback</a></p></li>
<li><p><a class="reference internal" href="#metric-loadermetriccallback" id="id8">Metric – LoaderMetricCallback</a></p></li>
<li><p><a class="reference internal" href="#metric-metricaggregationcallback" id="id9">Metric – MetricAggregationCallback</a></p></li>
<li><p><a class="reference internal" href="#misc-checkruncallback" id="id10">Misc – CheckRunCallback</a></p></li>
<li><p><a class="reference internal" href="#misc-earlystoppingcallback" id="id11">Misc – EarlyStoppingCallback</a></p></li>
<li><p><a class="reference internal" href="#misc-timercallback" id="id12">Misc – TimerCallback</a></p></li>
<li><p><a class="reference internal" href="#misc-tqdmcallback" id="id13">Misc – TqdmCallback</a></p></li>
<li><p><a class="reference internal" href="#onnxcallback" id="id14">OnnxCallback</a></p></li>
<li><p><a class="reference internal" href="#optimizercallback" id="id15">OptimizerCallback</a></p></li>
<li><p><a class="reference internal" href="#optunapruningcallback" id="id16">OptunaPruningCallback</a></p></li>
<li><p><a class="reference internal" href="#periodicloadercallback" id="id17">PeriodicLoaderCallback</a></p></li>
<li><p><a class="reference internal" href="#pruningcallback" id="id18">PruningCallback</a></p></li>
<li><p><a class="reference internal" href="#quantizationcallback" id="id19">QuantizationCallback</a></p></li>
<li><p><a class="reference internal" href="#scheduler-schedulercallback" id="id20">Scheduler – SchedulerCallback</a></p></li>
<li><p><a class="reference internal" href="#scheduler-lrfinder" id="id21">Scheduler – LRFinder</a></p></li>
<li><p><a class="reference internal" href="#tracing" id="id22">Tracing</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#module-catalyst.callbacks.metrics" id="id23">Metric</a></p>
<ul>
<li><p><a class="reference internal" href="#accuracy-accuracycallback" id="id24">Accuracy - AccuracyCallback</a></p></li>
<li><p><a class="reference internal" href="#accuracy-multilabelaccuracycallback" id="id25">Accuracy - MultilabelAccuracyCallback</a></p></li>
<li><p><a class="reference internal" href="#auccallback" id="id26">AUCCallback</a></p></li>
<li><p><a class="reference internal" href="#classification-precisionrecallf1supportcallback" id="id27">Classification – PrecisionRecallF1SupportCallback</a></p></li>
<li><p><a class="reference internal" href="#classification-multilabelprecisionrecallf1supportcallback" id="id28">Classification – MultilabelPrecisionRecallF1SupportCallback</a></p></li>
<li><p><a class="reference internal" href="#cmcscorecallback" id="id29">CMCScoreCallback</a></p></li>
<li><p><a class="reference internal" href="#confusionmatrixcallback" id="id30">ConfusionMatrixCallback</a></p></li>
<li><p><a class="reference internal" href="#functionalmetriccallback" id="id31">FunctionalMetricCallback</a></p></li>
<li><p><a class="reference internal" href="#recsys-hitratecallback" id="id32">RecSys – HitrateCallback</a></p></li>
<li><p><a class="reference internal" href="#recsys-mapcallback" id="id33">RecSys – MAPCallback</a></p></li>
<li><p><a class="reference internal" href="#recsys-mrrcallback" id="id34">RecSys – MRRCallback</a></p></li>
<li><p><a class="reference internal" href="#recsys-ndcgcallback" id="id35">RecSys – NDCGCallback</a></p></li>
<li><p><a class="reference internal" href="#segmentation-dicecallback" id="id36">Segmentation – DiceCallback</a></p></li>
<li><p><a class="reference internal" href="#segmentation-ioucallback" id="id37">Segmentation – IOUCallback</a></p></li>
<li><p><a class="reference internal" href="#segmentation-trevskycallback" id="id38">Segmentation – TrevskyCallback</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="module-catalyst.callbacks">
<span id="run"></span><h2><a class="toc-backref" href="#id1">Run</a><a class="headerlink" href="#module-catalyst.callbacks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="batchoverfitcallback">
<h3><a class="toc-backref" href="#id2">BatchOverfitCallback</a><a class="headerlink" href="#batchoverfitcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.batch_overfit.BatchOverfitCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.batch_overfit.</code><code class="sig-name descname">BatchOverfitCallback</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/batch_overfit.html#BatchOverfitCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.batch_overfit.BatchOverfitCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback to overfit loaders with specified number of batches.
By default we use <code class="docutils literal notranslate"><span class="pre">1</span></code> batch for loader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – loader names and their number of batches to overfit.</p>
</dd>
</dl>
<p>For example, if you have <code class="docutils literal notranslate"><span class="pre">train</span></code>, <code class="docutils literal notranslate"><span class="pre">train_additional</span></code>,
<code class="docutils literal notranslate"><span class="pre">valid</span></code> and <code class="docutils literal notranslate"><span class="pre">valid_additional</span></code> loaders and wan’t to overfit
<code class="docutils literal notranslate"><span class="pre">train</span></code> on first 1 batch,
<code class="docutils literal notranslate"><span class="pre">train_additional</span></code> on first 2 batches,
<code class="docutils literal notranslate"><span class="pre">valid</span></code> - on first 20% of batches
and <code class="docutils literal notranslate"><span class="pre">valid_additional</span></code> - on 50% batches:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">catalyst.dl</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SupervisedRunner</span><span class="p">,</span> <span class="n">BatchOverfitCallback</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">loaders</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;train_additional&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;valid_additional&quot;</span><span class="p">:</span><span class="o">...</span>
    <span class="p">}</span>
    <span class="o">...</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="o">...</span>
        <span class="n">BatchOverfitCallback</span><span class="p">(</span>
            <span class="n">train_additional</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">valid</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">valid_additional</span><span class="o">=</span><span class="mf">0.5</span>
        <span class="p">),</span>
        <span class="o">...</span>
    <span class="p">]</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Minimal working example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>
<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">dl</span>

<span class="c1"># data</span>
<span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e1</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">}</span>

<span class="c1"># model, criterion, optimizer, scheduler</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">MultiStepLR</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="c1"># model training</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logdir&quot;</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">dl</span><span class="o">.</span><span class="n">BatchOverfitCallback</span><span class="p">(</span><span class="n">train</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">valid</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)]</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="batchtransformcallback">
<h3><a class="toc-backref" href="#id3">BatchTransformCallback</a><a class="headerlink" href="#batchtransformcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.batch_transform.BatchTransformCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.batch_transform.</code><code class="sig-name descname">BatchTransformCallback</code><span class="sig-paren">(</span><em class="sig-param">transform: Sequence[Union[dict, torch.nn.modules.module.Module]], input_key: Union[str, int] = 'image', output_key: Union[str, int, None] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/batch_transform.html#BatchTransformCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.batch_transform.BatchTransformCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback to perform data augmentations on GPU using kornia library.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transform</strong> – <p>define augmentations to apply on a batch</p>
<p>If a sequence of transforms passed, then each element
should be either <code class="docutils literal notranslate"><span class="pre">kornia.augmentation.AugmentationBase2D</span></code>,
<code class="docutils literal notranslate"><span class="pre">kornia.augmentation.AugmentationBase3D</span></code>, or <code class="docutils literal notranslate"><span class="pre">nn.Module</span></code>
compatible with kornia interface.</p>
<p>If a sequence of params (<code class="docutils literal notranslate"><span class="pre">dict</span></code>) passed, then each
element of the sequence must contain <code class="docutils literal notranslate"><span class="pre">'transform'</span></code> key with
an augmentation name as a value. Please note that in this case
to use custom augmentation you should add it to the
<cite>REGISTRY</cite> registry first.</p>
</p></li>
<li><p><strong>input_key</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em>) – key in batch dict mapping to transform, e.g. <cite>‘image’</cite></p></li>
<li><p><strong>output_key</strong> – key to use to store the result
of the transform, defaults to <cite>input_key</cite> if not provided</p></li>
</ul>
</dd>
</dl>
<p>Look at <a class="reference external" href="https://arxiv.org/pdf/1910.02190.pdf">Kornia: an Open Source Differentiable Computer Vision
Library for PyTorch</a> for details.</p>
<p>Usage example for notebook API:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">kornia</span> <span class="kn">import</span> <span class="n">augmentation</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">functional</span> <span class="k">as</span> <span class="n">F</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>

<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">dl</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.data.transforms</span> <span class="kn">import</span> <span class="n">ToTensor</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.datasets</span> <span class="kn">import</span> <span class="n">MNIST</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.callbacks.kornia_transform</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BatchTransformCallback</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">metrics</span>


<span class="k">class</span> <span class="nc">CustomRunner</span><span class="p">(</span><span class="n">dl</span><span class="o">.</span><span class="n">Runner</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">predict_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
        <span class="c1"># model inference step</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span>
            <span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">handle_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
        <span class="c1"># model train/valid step</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
        <span class="n">y_hat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">accuracy01</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_metrics</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="s2">&quot;accuracy01&quot;</span><span class="p">:</span> <span class="n">accuracy01</span><span class="p">}</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_train_loader</span><span class="p">:</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>

<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">MNIST</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">MNIST</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">}</span>
<span class="n">transforms</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">augmentation</span><span class="o">.</span><span class="n">RandomAffine</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">)),</span>
<span class="p">]</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">CustomRunner</span><span class="p">()</span>

<span class="c1"># model training</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logs&quot;</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">BatchTransformCallback</span><span class="p">(</span><span class="n">transforms</span><span class="p">,</span> <span class="n">input_key</span><span class="o">=</span><span class="mi">0</span><span class="p">)],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>To apply augmentations only during specific loader e.g. only during
training <code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callbacks.control_flow.ControlFlowCallback</span></code>
callback can be used. For config API it can look like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">callbacks_params</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="l l-Scalar l-Scalar-Plain">train_transforms</span><span class="p p-Indicator">:</span>
    <span class="nt">_wrapper</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ControlFlowCallback</span>
      <span class="nt">loaders</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">train</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">BatchTransformCallback</span>
    <span class="nt">transform</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">transform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kornia.RandomAffine</span>
        <span class="nt">degrees</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">-15</span><span class="p p-Indicator">,</span> <span class="nv">20</span><span class="p p-Indicator">]</span>
        <span class="nt">scale</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">0.75</span><span class="p p-Indicator">,</span> <span class="nv">1.25</span><span class="p p-Indicator">]</span>
        <span class="nt">return_transform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class="p p-Indicator">-</span> <span class="nt">transform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kornia.ColorJitter</span>
        <span class="nt">brightness</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1</span>
        <span class="nt">contrast</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1</span>
        <span class="nt">saturation</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1</span>
        <span class="nt">return_transform</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
    <span class="nt">input_key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">image</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="checkpointcallback">
<h3><a class="toc-backref" href="#id4">CheckpointCallback</a><a class="headerlink" href="#checkpointcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.checkpoint.CheckpointCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.checkpoint.</code><code class="sig-name descname">CheckpointCallback</code><span class="sig-paren">(</span><em class="sig-param">logdir: str = None</em>, <em class="sig-param">loader_key: str = None</em>, <em class="sig-param">metric_key: str = None</em>, <em class="sig-param">minimize: bool = None</em>, <em class="sig-param">min_delta: float = 1e-06</em>, <em class="sig-param">save_n_best: int = 1</em>, <em class="sig-param">load_on_stage_start: Union[str</em>, <em class="sig-param">Dict[str</em>, <em class="sig-param">str]] = None</em>, <em class="sig-param">load_on_stage_end: Union[str</em>, <em class="sig-param">Dict[str</em>, <em class="sig-param">str]] = None</em>, <em class="sig-param">metrics_filename: str = '_metrics.json'</em>, <em class="sig-param">mode: str = 'all'</em>, <em class="sig-param">use_logdir_postfix: bool = False</em>, <em class="sig-param">use_runner_logdir: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/checkpoint.html#CheckpointCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.checkpoint.CheckpointCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.checkpoint.ICheckpointCallback</span></code></p>
<p>Checkpoint callback to save/restore your model/criterion/optimizer/scheduler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logdir</strong> – directory to store chekpoints</p></li>
<li><p><strong>loader_key</strong> – loader key for best model selection (based on metric score over the dataset)</p></li>
<li><p><strong>metric_key</strong> – metric key for best model selection (based on metric score over the dataset)</p></li>
<li><p><strong>minimize</strong> – boolean flag to minimize the required metric</p></li>
<li><p><strong>min_delta</strong> – minimal delta for metric improve</p></li>
<li><p><strong>save_n_best</strong> – number of best checkpoint to keep,
if <code class="docutils literal notranslate"><span class="pre">0</span></code> then  store only last state of model and
<code class="docutils literal notranslate"><span class="pre">load_on_stage_end</span></code> should be one of
<code class="docutils literal notranslate"><span class="pre">last</span></code> or <code class="docutils literal notranslate"><span class="pre">last_full</span></code>.</p></li>
<li><p><strong>load_on_stage_start</strong> (<em>str</em><em> or </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – <p>load specified
state/model at stage start.</p>
<p>If passed <strong>string</strong> then will be performed initialization from
specified state (<code class="docutils literal notranslate"><span class="pre">best</span></code>/<code class="docutils literal notranslate"><span class="pre">best_full</span></code>/<code class="docutils literal notranslate"><span class="pre">last</span></code>/<code class="docutils literal notranslate"><span class="pre">last_full</span></code>)
or checkpoint file.</p>
<p>If passed <strong>dict</strong> then will be performed initialization only
for specified parts - model, criterion, optimizer, scheduler.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># possible checkpoints to use:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#   &quot;best&quot;/&quot;best_full&quot;/&quot;last&quot;/&quot;last_full&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#   or path to specific checkpoint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to_load</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;path/to/checkpoint.pth&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;criterion&quot;</span><span class="p">:</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;optimizer&quot;</span><span class="p">:</span> <span class="s2">&quot;last_full&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s2">&quot;scheduler&quot;</span><span class="p">:</span> <span class="s2">&quot;best_full&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CheckpointCallback</span><span class="p">(</span><span class="n">load_on_stage_start</span><span class="o">=</span><span class="n">to_load</span><span class="p">)</span>
</pre></div>
</div>
<p>All other keys instead of <code class="docutils literal notranslate"><span class="pre">&quot;model&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;criterion&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;optimizer&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;scheduler&quot;</span></code> will be ignored.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">None</span></code> or an empty dict (or dict without mentioned
above keys) then no action is required at stage start and:</p>
<ul>
<li><p>Config API - will be used best state of model</p></li>
<li><p>Notebook API - no action will be performed (will be used the last state)</p></li>
</ul>
<p><strong>NOTE:</strong> Loading will be performed on all stages except first.</p>
<p><strong>NOTE:</strong> Criterion, optimizer and scheduler are optional keys
and should be loaded from full checkpoint.</p>
<p>Model state can be loaded from any checkpoint.</p>
<p>When dict contains keys for model and some other part
(for example <code class="docutils literal notranslate"><span class="pre">{&quot;model&quot;:</span> <span class="pre">&quot;last&quot;,</span> <span class="pre">&quot;optimizer&quot;:</span> <span class="pre">&quot;last&quot;}</span></code>)
and they match in prefix (<code class="docutils literal notranslate"><span class="pre">&quot;best&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&quot;best_full&quot;</span></code>) then will be loaded full checkpoint
because it contains required states.</p>
</p></li>
<li><p><strong>load_on_stage_end</strong> (<em>str</em><em> or </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – <p>load specified
state/model at stage end.</p>
<p>If passed <strong>string</strong> then will be performed initialization from
specified state (<code class="docutils literal notranslate"><span class="pre">best</span></code>/<code class="docutils literal notranslate"><span class="pre">best_full</span></code>/<code class="docutils literal notranslate"><span class="pre">last</span></code>/<code class="docutils literal notranslate"><span class="pre">last_full</span></code>)
or checkpoint file.</p>
<p>If passed <strong>dict</strong> then will be performed initialization only
for specified parts - model, criterion, optimizer, scheduler.
Logic for dict is the same as for <code class="docutils literal notranslate"><span class="pre">load_on_stage_start</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">None</span></code> then no action is required at stage end
and will be used the last runner.</p>
<p><strong>NOTE:</strong> Loading will be performed always at stage end.</p>
</p></li>
<li><p><strong>metrics_filename</strong> – filename to save metrics
in checkpoint folder.
Must ends on <code class="docutils literal notranslate"><span class="pre">.json</span></code> or <code class="docutils literal notranslate"><span class="pre">.yml</span></code></p></li>
<li><p><strong>mode</strong> – checkpoining mode, could be <code class="docutils literal notranslate"><span class="pre">all</span></code>, <code class="docutils literal notranslate"><span class="pre">full</span></code>, <code class="docutils literal notranslate"><span class="pre">model</span></code></p></li>
<li><p><strong>use_logdir_postfix</strong> – boolean flag to use extra prefix <code class="docutils literal notranslate"><span class="pre">checkpoints</span></code> for logdir</p></li>
<li><p><strong>use_runner_logdir</strong> – boolean flag to use <code class="docutils literal notranslate"><span class="pre">runner._logdir</span></code> as logdir</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="controlflowcallback">
<h3><a class="toc-backref" href="#id5">ControlFlowCallback</a><a class="headerlink" href="#controlflowcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.control_flow.ControlFlowCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.control_flow.</code><code class="sig-name descname">ControlFlowCallback</code><span class="sig-paren">(</span><em class="sig-param">base_callback: catalyst.core.callback.Callback, epochs: Union[int, Sequence[int]] = None, ignore_epochs: Union[int, Sequence[int]] = None, loaders: Union[str, Sequence[str], Mapping[str, Union[int, Sequence[int]]]] = None, ignore_loaders: Union[str, Sequence[str], Mapping[str, Union[int, Sequence[int]]]] = None, filter_fn: Union[str, Callable[[str, int, str], bool]] = None, use_global_epochs: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/control_flow.html#ControlFlowCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.control_flow.ControlFlowCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.CallbackWrapper" title="catalyst.core.callback.CallbackWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.CallbackWrapper</span></code></a></p>
<p>Enable/disable callback execution on different
stages, loaders and epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_callback</strong> – callback to wrap</p></li>
<li><p><strong>epochs</strong> – <p>epochs where
need to <strong>enable</strong> callback, on other epochs
callback will be disabled.</p>
<p>If passed int/float then callback will be enabled
with period specified as epochs value
(epochs expression <code class="docutils literal notranslate"><span class="pre">epoch_number</span> <span class="pre">%</span> <span class="pre">epochs</span> <span class="pre">==</span> <span class="pre">0</span></code>)
and disabled on other epochs.</p>
<p>If passed list of epochs then will be executed callback
on specified epochs.</p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</p></li>
<li><p><strong>ignore_epochs:</strong> – <p>epochs where: need to <strong>disable</strong> callback, on other epochs
callback will be enabled.</p>
<p>If passed int/float then callback will be disabled
with period specified as epochs value
(epochs expression <code class="docutils literal notranslate"><span class="pre">epoch_number</span> <span class="pre">%</span> <span class="pre">epochs</span> <span class="pre">!=</span> <span class="pre">0</span></code>)
and enabled on other epochs.</p>
<p>If passed list of epochs then will be disabled callback
on specified epochs.</p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</p></li>
<li><p><strong>loaders</strong> (<em>str/Sequence</em><em>[</em><em>str</em><em>]</em><em>/Mapping</em><em>[</em><em>str</em><em>, </em><em>int/Sequence</em><em>[</em><em>str</em><em>]</em><em>]</em>) – <p>loaders where should be <strong>enabled</strong> callback, on
other loaders callback will be disabled.</p>
<p>If passed string object then will be disabled callback for
loader with specified name.</p>
<p>If passed list/tuple of strings then will be disabled callback
for loaders with specified names.</p>
<p>If passed dictionary where key is a string and values
int or list of integers then callback will be
disabled on epochs (dictionary value) for specified
loader (dictionary key).</p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</p></li>
<li><p><strong>ignore_loaders</strong> (<em>str/Sequence</em><em>[</em><em>str</em><em>]</em><em>/Mapping</em><em>[</em><em>str</em><em>, </em><em>int/Sequence</em><em>[</em><em>str</em><em>]</em><em>]</em>) – <p>loader names where should be <strong>disabled</strong> callback, on
other loaders callback will be enabled.</p>
<p>If passed string object then will be disabled callback for
loader with specified name.</p>
<p>If passed list/tuple of strings then will be disabled callback
for loaders with specified names.</p>
<p>If passed dictionary where key is a string and values
int or list of integers then callback will be
disabled on epochs (dictionary value) for specified
loader (dictionary key).</p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</p></li>
<li><p><strong>filter_fn</strong> (<em>str</em><em> or </em><em>Callable</em><em>[</em><em>[</em><em>str</em><em>, </em><em>int</em><em>, </em><em>str</em><em>]</em><em>, </em><em>bool</em><em>]</em>) – <p>function to use instead of <code class="docutils literal notranslate"><span class="pre">loaders</span></code> or <code class="docutils literal notranslate"><span class="pre">epochs</span></code> arguments.</p>
<p>If the object passed to a <code class="docutils literal notranslate"><span class="pre">filter_fn</span></code> is a string
then it will be interpreted as python code. Expected
lambda function with three arguments stage name (str),
epoch number (int), loader name (str) and this function
should return <code class="docutils literal notranslate"><span class="pre">True</span></code> if callback should be enabled
on some condition.</p>
<p>If passed callable object then it should accept
three arguments - stage name (str), epoch number (int),
loader name (str) and should return <code class="docutils literal notranslate"><span class="pre">True</span></code> if callback
should be enabled on some condition othervise should
return <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>Default value is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># enable callback on all loaders</span>
<span class="c1"># exept &quot;train&quot; loader every 2 epochs</span>
<span class="n">ControlFlowCallback</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">filter_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="n">l</span> <span class="o">!=</span> <span class="s2">&quot;train&quot;</span> <span class="ow">and</span> <span class="n">e</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="o">...</span>
<span class="p">)</span>
<span class="c1"># or with string equivalent</span>
<span class="n">ControlFlowCallback</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">filter_fn</span><span class="o">=</span><span class="s2">&quot;lambda s, e, l: l != &#39;train&#39; and e % 2 == 0&quot;</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
</p></li>
<li><p><strong>use_global_epochs</strong> – if <code class="docutils literal notranslate"><span class="pre">True</span></code> then
will be used global epochs instead of epochs in
a stage, the default value is <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please run experiment with
<code class="xref py py-class docutils literal notranslate"><span class="pre">check</span> <span class="pre">option</span></code>
to check if everything works as expected with this callback.</p>
</div>
<p>For example, if you don’t want to compute loss on a validation
you can ignore
<code class="xref py py-class docutils literal notranslate"><span class="pre">CriterionCallback</span></code>,
for <strong>notebook API</strong> need to wrap callback:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>
<span class="kn">from</span> <span class="nn">catalyst.dl</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SupervisedRunner</span><span class="p">,</span> <span class="n">AccuracyCallback</span><span class="p">,</span>
    <span class="n">CriterionCallback</span><span class="p">,</span> <span class="n">ControlFlowCallback</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span> <span class="o">=</span> <span class="mi">10_000</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">n_classes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">,</span> <span class="p">[</span><span class="n">num_samples</span><span class="p">])</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">TensorDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">MultiStepLR</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logdir&quot;</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">valid_metric</span><span class="o">=</span><span class="s2">&quot;accuracy03&quot;</span><span class="p">,</span>
    <span class="n">minimize_metric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="n">AccuracyCallback</span><span class="p">(</span>
            <span class="n">accuracy_args</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="p">),</span>
        <span class="n">ControlFlowCallback</span><span class="p">(</span>
            <span class="n">base_callback</span><span class="o">=</span><span class="n">CriterionCallback</span><span class="p">(),</span>
            <span class="n">ignore_loaders</span><span class="o">=</span><span class="s2">&quot;valid&quot;</span>  <span class="c1"># or loaders=&quot;train&quot;</span>
        <span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In <strong>config API</strong> need to use <code class="docutils literal notranslate"><span class="pre">_wrapper</span></code> argument:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">callbacks_params</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="l l-Scalar l-Scalar-Plain">loss</span><span class="p p-Indicator">:</span>
    <span class="nt">_wrapper</span><span class="p">:</span>
       <span class="nt">callback</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ControlFlowCallback</span>
       <span class="nt">ignore_loaders</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">valid</span>
    <span class="nt">callback</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CriterionCallback</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="criterioncallback">
<h3><a class="toc-backref" href="#id6">CriterionCallback</a><a class="headerlink" href="#criterioncallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.criterion.CriterionCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.criterion.</code><code class="sig-name descname">CriterionCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">metric_key: str</em>, <em class="sig-param">criterion_key: str = None</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/criterion.html#CriterionCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.criterion.CriterionCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metrics.functional_metric.FunctionalMetricCallback" title="catalyst.callbacks.metrics.functional_metric.FunctionalMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metrics.functional_metric.FunctionalMetricCallback</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.criterion.ICriterionCallback</span></code></p>
<p>Criterion callback, abstraction over criterion step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>metric_key</strong> – key to store computed metric in <code class="docutils literal notranslate"><span class="pre">runner.batch_metrics</span></code> dictionary</p></li>
<li><p><strong>criterion_key</strong> – A key to take a criterion in case
there are several of them, and they are in a dictionary format.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="metric-batchmetriccallback">
<h3><a class="toc-backref" href="#id7">Metric – BatchMetricCallback</a><a class="headerlink" href="#metric-batchmetriccallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metric.BatchMetricCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metric.</code><code class="sig-name descname">BatchMetricCallback</code><span class="sig-paren">(</span><em class="sig-param">metric: catalyst.metrics._metric.ICallbackBatchMetric, input_key: Union[str, Iterable[str], Dict[str, str]], target_key: Union[str, Iterable[str], Dict[str, str]], log_on_batch: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#BatchMetricCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.BatchMetricCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.MetricCallback</span></code></p>
<p>BatchMetricCallback implements batch-based metrics update and computation over loader</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> – metric to calculate in callback</p></li>
<li><p><strong>input_key</strong> – keys of tensors that should be used as inputs in metric calculation</p></li>
<li><p><strong>target_key</strong> – keys of tensors that should be used as targets in metric calculation</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="metric-loadermetriccallback">
<h3><a class="toc-backref" href="#id8">Metric – LoaderMetricCallback</a><a class="headerlink" href="#metric-loadermetriccallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metric.LoaderMetricCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metric.</code><code class="sig-name descname">LoaderMetricCallback</code><span class="sig-paren">(</span><em class="sig-param">metric: catalyst.metrics._metric.ICallbackLoaderMetric, input_key: Union[str, Iterable[str], Dict[str, str]], target_key: Union[str, Iterable[str], Dict[str, str]]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric.html#LoaderMetricCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric.LoaderMetricCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.MetricCallback</span></code></p>
<p>LoaderMetricCallback implements loader-based metrics update and computation over loader</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> – metric to calculate in callback</p></li>
<li><p><strong>input_key</strong> – keys of tensors that should be used as inputs in metric calculation</p></li>
<li><p><strong>target_key</strong> – keys of tensors that should be used as targets in metric calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="metric-metricaggregationcallback">
<h3><a class="toc-backref" href="#id9">Metric – MetricAggregationCallback</a><a class="headerlink" href="#metric-metricaggregationcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metric_aggregation.MetricAggregationCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metric_aggregation.</code><code class="sig-name descname">MetricAggregationCallback</code><span class="sig-paren">(</span><em class="sig-param">prefix: str, metrics: Union[str, List[str], Dict[str, float]] = None, mode: Union[str, Callable] = 'mean', scope: str = 'batch', multiplier: float = 1.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metric_aggregation.html#MetricAggregationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metric_aggregation.MetricAggregationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>A callback to aggregate several metrics in one value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> – new key for aggregated metric.</p></li>
<li><p><strong>metrics</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em><em>]</em>) – If not None,
it aggregates only the values from the metric by these keys.
for <code class="docutils literal notranslate"><span class="pre">weighted_sum</span></code> aggregation it must be a Dict[str, float].</p></li>
<li><p><strong>mode</strong> – function for aggregation.
Must be either <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">mean</span></code> or <code class="docutils literal notranslate"><span class="pre">weighted_sum</span></code> or user’s
function to aggregate metrics. This function must get dict of
metrics and runner and return aggregated metric. It can be
useful for complicated fine tuning with different losses that
depends on epochs and loader or something also</p></li>
<li><p><strong>scope</strong> – type of metric. Must be either <code class="docutils literal notranslate"><span class="pre">batch</span></code> or <code class="docutils literal notranslate"><span class="pre">loader</span></code></p></li>
<li><p><strong>multiplier</strong> – scale factor for the aggregated metric.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Loss is a weighted sum of cross entropy loss and binary cross entropy loss</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">dl</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># sample data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span><span class="p">,</span> <span class="n">num_classes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e1</span><span class="p">),</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="p">)</span> <span class="o">*</span> <span class="n">num_classes</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># pytorch loaders</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">}</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># model, criterion, optimizer, scheduler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">criterion</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ce&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">(),</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="s2">&quot;bce&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">BCEWithLogitsLoss</span><span class="p">()}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">MultiStepLR</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">CustomRunner</span><span class="p">(</span><span class="n">dl</span><span class="o">.</span><span class="n">Runner</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">handle_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">num_classes</span> <span class="o">=</span> <span class="n">logits</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">targets_onehot</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="n">num_classes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">batch</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="s2">&quot;logits&quot;</span><span class="p">:</span> <span class="n">logits</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="s2">&quot;targets&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="s2">&quot;targets_onehot&quot;</span><span class="p">:</span> <span class="n">targets_onehot</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">}</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># model training</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">runner</span> <span class="o">=</span> <span class="n">CustomRunner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logdir&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">dl</span><span class="o">.</span><span class="n">AccuracyCallback</span><span class="p">(</span><span class="n">input_key</span><span class="o">=</span><span class="s2">&quot;logits&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">target_key</span><span class="o">=</span><span class="s2">&quot;targets&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">num_classes</span><span class="o">=</span><span class="n">num_classes</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">dl</span><span class="o">.</span><span class="n">CriterionCallback</span><span class="p">(</span><span class="n">input_key</span><span class="o">=</span><span class="s2">&quot;logits&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">target_key</span><span class="o">=</span><span class="s2">&quot;targets&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">metric_key</span><span class="o">=</span><span class="s2">&quot;loss_ce&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>             <span class="n">criterion_key</span><span class="o">=</span><span class="s2">&quot;ce&quot;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">dl</span><span class="o">.</span><span class="n">CriterionCallback</span><span class="p">(</span><span class="n">input_key</span><span class="o">=</span><span class="s2">&quot;logits&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="n">target_key</span><span class="o">=</span><span class="s2">&quot;targets_onehot&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="n">metric_key</span><span class="o">=</span><span class="s2">&quot;loss_bce&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="n">criterion_key</span><span class="o">=</span><span class="s2">&quot;bce&quot;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="c1"># loss aggregation</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">dl</span><span class="o">.</span><span class="n">MetricAggregationCallback</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">metrics</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;loss_ce&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span> <span class="s1">&#39;loss_bce&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;weighted_sum&#39;</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">dl</span><span class="o">.</span><span class="n">OptimizerCallback</span><span class="p">(</span><span class="n">metric_key</span><span class="o">=</span><span class="s2">&quot;loss&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="misc-checkruncallback">
<h3><a class="toc-backref" href="#id10">Misc – CheckRunCallback</a><a class="headerlink" href="#misc-checkruncallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.misc.CheckRunCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.misc.</code><code class="sig-name descname">CheckRunCallback</code><span class="sig-paren">(</span><em class="sig-param">num_batch_steps: int = 3</em>, <em class="sig-param">num_epoch_steps: int = 3</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/misc.html#CheckRunCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.misc.CheckRunCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Executes only a pipeline part from the run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_batch_steps</strong> – number of batches to iterate in epoch</p></li>
<li><p><strong>num_epoch_steps</strong> – number of epoch to perform in a stage</p></li>
</ul>
</dd>
</dl>
<p>Minimal working example (Notebook API):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>
<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">dl</span>

<span class="c1"># data</span>
<span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e1</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">}</span>

<span class="c1"># model, criterion, optimizer, scheduler</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">MultiStepLR</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="c1"># model training</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logdir&quot;</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="n">dl</span><span class="o">.</span><span class="n">CheckRunCallback</span><span class="p">(</span><span class="n">num_batch_steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">num_epoch_steps</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="misc-earlystoppingcallback">
<h3><a class="toc-backref" href="#id11">Misc – EarlyStoppingCallback</a><a class="headerlink" href="#misc-earlystoppingcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.misc.EarlyStoppingCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.misc.</code><code class="sig-name descname">EarlyStoppingCallback</code><span class="sig-paren">(</span><em class="sig-param">patience: int</em>, <em class="sig-param">loader_key: str</em>, <em class="sig-param">metric_key: str</em>, <em class="sig-param">minimize: bool = True</em>, <em class="sig-param">min_delta: float = 1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/misc.html#EarlyStoppingCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.misc.EarlyStoppingCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.misc.IEpochMetricHandlerCallback</span></code></p>
<p>Stage early stop based on metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patience</strong> – number of epochs with no improvement
after which training will be stopped.</p></li>
<li><p><strong>loader_key</strong> – loader key for early stopping (based on metric score over the dataset)</p></li>
<li><p><strong>metric_key</strong> – metric key for early stopping (based on metric score over the dataset)</p></li>
<li><p><strong>minimize</strong> – if <code class="docutils literal notranslate"><span class="pre">True</span></code> then expected that metric should
decrease and early stopping will be performed only when metric
stops decreasing. If <code class="docutils literal notranslate"><span class="pre">False</span></code> then expected
that metric should increase. Default value <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>min_delta</strong> – minimum change in the monitored metric
to qualify as an improvement, i.e. an absolute change
of less than min_delta, will count as no improvement,
default value is <code class="docutils literal notranslate"><span class="pre">1e-6</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="catalyst.callbacks.misc.EarlyStoppingCallback.handle_score_is_better">
<code class="sig-name descname">handle_score_is_better</code><span class="sig-paren">(</span><em class="sig-param">runner: catalyst.core.runner.IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/misc.html#EarlyStoppingCallback.handle_score_is_better"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.misc.EarlyStoppingCallback.handle_score_is_better" title="Permalink to this definition">¶</a></dt>
<dd><p>Event handler.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.misc.EarlyStoppingCallback.handle_score_is_not_better">
<code class="sig-name descname">handle_score_is_not_better</code><span class="sig-paren">(</span><em class="sig-param">runner: catalyst.core.runner.IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/misc.html#EarlyStoppingCallback.handle_score_is_not_better"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.misc.EarlyStoppingCallback.handle_score_is_not_better" title="Permalink to this definition">¶</a></dt>
<dd><p>Event handler.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="misc-timercallback">
<h3><a class="toc-backref" href="#id12">Misc – TimerCallback</a><a class="headerlink" href="#misc-timercallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.misc.TimerCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.misc.</code><code class="sig-name descname">TimerCallback</code><a class="reference internal" href="../_modules/catalyst/callbacks/misc.html#TimerCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.misc.TimerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Logs pipeline execution time.</p>
</dd></dl>

</div>
<div class="section" id="misc-tqdmcallback">
<h3><a class="toc-backref" href="#id13">Misc – TqdmCallback</a><a class="headerlink" href="#misc-tqdmcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.misc.TqdmCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.misc.</code><code class="sig-name descname">TqdmCallback</code><a class="reference internal" href="../_modules/catalyst/callbacks/misc.html#TqdmCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.misc.TqdmCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Logs the params into tqdm console.</p>
<dl class="method">
<dt id="catalyst.callbacks.misc.TqdmCallback.on_exception">
<code class="sig-name descname">on_exception</code><span class="sig-paren">(</span><em class="sig-param">runner: catalyst.core.runner.IRunner</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/misc.html#TqdmCallback.on_exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.misc.TqdmCallback.on_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Called if an Exception was raised.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="onnxcallback">
<h3><a class="toc-backref" href="#id14">OnnxCallback</a><a class="headerlink" href="#onnxcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.onnx.OnnxCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.onnx.</code><code class="sig-name descname">OnnxCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str, logdir: Union[str, pathlib.Path] = None, filename: str = 'onnx.py', method_name: str = 'forward', input_names: Iterable = None, output_names: List[str] = None, dynamic_axes: Union[Dict[str, int], Dict[str, Dict[str, int]]] = None, opset_version: int = 9, do_constant_folding: bool = False, verbose: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/onnx.html#OnnxCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.onnx.OnnxCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback for converting model to onnx runtime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key from <code class="docutils literal notranslate"><span class="pre">runner.batch</span></code> to use for onnx export</p></li>
<li><p><strong>logdir</strong> – path to folder for saving</p></li>
<li><p><strong>filename</strong> – filename</p></li>
<li><p><strong>method_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Forward pass method to be converted. Defaults to “forward”.</p></li>
<li><p><strong>input_names</strong> (<em>Iterable</em><em>, </em><em>optional</em>) – name of inputs in graph. Defaults to None.</p></li>
<li><p><strong>output_names</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – name of outputs in graph. Defaults to None.</p></li>
<li><p><strong>dynamic_axes</strong> (<em>Union</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – axes
with dynamic shapes. Defaults to None.</p></li>
<li><p><strong>opset_version</strong> (<em>int</em><em>, </em><em>optional</em>) – Defaults to 9.</p></li>
<li><p><strong>do_constant_folding</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the constant-folding optimization
is applied to the model during export. Defaults to False.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>default False</em>) – if specified, we will print out a debug
description of the trace being exported.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>

<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">dl</span>
<span class="kn">from</span> <span class="nn">catalyst.data.transforms</span> <span class="kn">import</span> <span class="n">ToTensor</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.datasets</span> <span class="kn">import</span> <span class="n">MNIST</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.nn.modules</span> <span class="kn">import</span> <span class="n">Flatten</span>

<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">MNIST</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()</span>
        <span class="p">),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">MNIST</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()</span>
        <span class="p">),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">Flatten</span><span class="p">(),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">dl</span><span class="o">.</span><span class="n">OnnxCallback</span><span class="p">(</span><span class="n">input_key</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logs&quot;</span><span class="p">)],</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logs&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="optimizercallback">
<h3><a class="toc-backref" href="#id15">OptimizerCallback</a><a class="headerlink" href="#optimizercallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.optimizer.OptimizerCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.optimizer.</code><code class="sig-name descname">OptimizerCallback</code><span class="sig-paren">(</span><em class="sig-param">metric_key: str</em>, <em class="sig-param">model_key: str = None</em>, <em class="sig-param">optimizer_key: str = None</em>, <em class="sig-param">accumulation_steps: int = 1</em>, <em class="sig-param">grad_clip_fn: Union[str</em>, <em class="sig-param">Callable] = None</em>, <em class="sig-param">grad_clip_params: Dict = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/optimizer.html#OptimizerCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.optimizer.OptimizerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.optimizer.IOptimizerCallback</span></code></p>
<p>Optimizer callback, abstraction over optimizer step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric_key</strong> – a key to get loss from <code class="docutils literal notranslate"><span class="pre">runner.batch_metrics</span></code></p></li>
<li><p><strong>model_key</strong> – a key to select a model from <code class="docutils literal notranslate"><span class="pre">runner.model</span></code> in case
there are several of them and they are in a dictionary format.</p></li>
<li><p><strong>optimizer_key</strong> – a key to select a optimizer from <code class="docutils literal notranslate"><span class="pre">runner.optimizer</span></code> in case
there are several of them and they are in a dictionary format.</p></li>
<li><p><strong>accumulation_steps</strong> – number of steps before <code class="docutils literal notranslate"><span class="pre">model.zero_grad()</span></code></p></li>
<li><p><strong>grad_clip_fn</strong> – callable gradient cliping function or it’s name or</p></li>
<li><p><strong>grad_clip_params</strong> – key-value parameters for grad_clip_fn</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="optunapruningcallback">
<h3><a class="toc-backref" href="#id16">OptunaPruningCallback</a><a class="headerlink" href="#optunapruningcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.optuna.OptunaPruningCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.optuna.</code><code class="sig-name descname">OptunaPruningCallback</code><span class="sig-paren">(</span><em class="sig-param">loader_key: str</em>, <em class="sig-param">metric_key: str</em>, <em class="sig-param">minimize: bool</em>, <em class="sig-param">min_delta: float = 1e-06</em>, <em class="sig-param">trial: optuna.trial._trial.Trial = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/optuna.html#OptunaPruningCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.optuna.OptunaPruningCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Optuna callback for pruning unpromising runs.
This callback can be used for early stopping (pruning) unpromising runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loader_key</strong> – loader key for best model selection (based on metric score over the dataset)</p></li>
<li><p><strong>metric_key</strong> – metric key for best model selection (based on metric score over the dataset)</p></li>
<li><p><strong>minimize</strong> – boolean flag to minimize the required metric</p></li>
<li><p><strong>min_delta</strong> – minimal delta for metric improve</p></li>
<li><p><strong>trial</strong> – Optuna.Trial for experiment.</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>

<span class="kn">from</span> <span class="nn">catalyst.dl</span> <span class="kn">import</span> <span class="n">SupervisedRunner</span><span class="p">,</span> <span class="n">OptunaPruningCallback</span>

<span class="c1"># some python code ...</span>

<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">Trial</span><span class="p">):</span>
    <span class="c1"># standard optuna code for model and/or optimizer suggestion ...</span>
    <span class="n">runner</span> <span class="o">=</span> <span class="n">SupervisedRunner</span><span class="p">()</span>
    <span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
        <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
            <span class="n">OptunaPruningCallback</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span>
            <span class="c1"># some other callbacks ...</span>
        <span class="p">],</span>
        <span class="n">num_epochs</span><span class="o">=</span><span class="n">num_epochs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">runner</span><span class="o">.</span><span class="n">best_valid_metrics</span><span class="p">[</span><span class="n">runner</span><span class="o">.</span><span class="n">valid_metric</span><span class="p">]</span>

<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
<p>Config API is supported through <cite>catalyst-dl tune</cite> command.</p>
</dd></dl>

</div>
<div class="section" id="periodicloadercallback">
<h3><a class="toc-backref" href="#id17">PeriodicLoaderCallback</a><a class="headerlink" href="#periodicloadercallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.periodic_loader.PeriodicLoaderCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.periodic_loader.</code><code class="sig-name descname">PeriodicLoaderCallback</code><span class="sig-paren">(</span><em class="sig-param">valid_loader_key: str</em>, <em class="sig-param">valid_metric_key: str</em>, <em class="sig-param">minimize: bool = True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/periodic_loader.html#PeriodicLoaderCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.periodic_loader.PeriodicLoaderCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback for runing loaders with specified period.
To disable loader use <code class="docutils literal notranslate"><span class="pre">0</span></code> as period (if specified <code class="docutils literal notranslate"><span class="pre">0</span></code> for validation loader
then will be raised an error).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – loader names and their run periods.</p>
</dd>
</dl>
<p>For example, if you have <code class="docutils literal notranslate"><span class="pre">train</span></code>, <code class="docutils literal notranslate"><span class="pre">train_additional</span></code>,
<code class="docutils literal notranslate"><span class="pre">valid</span></code> and <code class="docutils literal notranslate"><span class="pre">valid_additional</span></code> loaders and wan’t to
use <code class="docutils literal notranslate"><span class="pre">train_additional</span></code> every 2 epochs, <code class="docutils literal notranslate"><span class="pre">valid</span></code> - every
3 epochs and <code class="docutils literal notranslate"><span class="pre">valid_additional</span></code> - every 5 epochs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">catalyst.dl</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SupervisedRunner</span><span class="p">,</span> <span class="n">PeriodicLoaderRunnerCallback</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">loaders</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;train_additional&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;valid_additional&quot;</span><span class="p">:</span><span class="o">...</span>
    <span class="p">}</span>
    <span class="o">...</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="o">...</span>
        <span class="n">PeriodicLoaderRunnerCallback</span><span class="p">(</span>
            <span class="n">train_additional</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">valid</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">valid_additional</span><span class="o">=</span><span class="mi">5</span>
        <span class="p">),</span>
        <span class="o">...</span>
    <span class="p">]</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="pruningcallback">
<h3><a class="toc-backref" href="#id18">PruningCallback</a><a class="headerlink" href="#pruningcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.pruning.PruningCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.pruning.</code><code class="sig-name descname">PruningCallback</code><span class="sig-paren">(</span><em class="sig-param">pruning_fn: Union[Callable, str], amount: Union[int, float], keys_to_prune: Optional[List[str]] = None, prune_on_epoch_end: Optional[bool] = False, prune_on_stage_end: Optional[bool] = True, remove_reparametrization_on_stage_end: Optional[bool] = True, layers_to_prune: Optional[List[str]] = None, dim: Optional[int] = None, l_norm: Optional[int] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/pruning.html#PruningCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.pruning.PruningCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>This callback prunes network parameters during and/or after training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pruning_fn</strong> – function from torch.nn.utils.prune module
or your based on BasePruningMethod. Can be string e.g.
<cite>“l1_unstructured”</cite>. See pytorch docs for more details.</p></li>
<li><p><strong>amount</strong> – quantity of parameters to prune.
If float, should be between 0.0 and 1.0 and
represent the fraction of parameters to prune.
If int, it represents the absolute number
of parameters to prune.</p></li>
<li><p><strong>keys_to_prune</strong> – list of strings. Determines
which tensor in modules will be pruned.</p></li>
<li><p><strong>prune_on_epoch_end</strong> – bool flag determines call or not
to call pruning_fn on epoch end.</p></li>
<li><p><strong>prune_on_stage_end</strong> – bool flag determines call or not
to call pruning_fn on stage end.</p></li>
<li><p><strong>remove_reparametrization_on_stage_end</strong> – if True then all
reparametrization pre-hooks and tensors with mask
will be removed on stage end.</p></li>
<li><p><strong>layers_to_prune</strong> – list of strings - module names to be pruned.
If None provided then will try to prune every module in
model.</p></li>
<li><p><strong>dim</strong> – if you are using structured pruning method you need
to specify dimension.</p></li>
<li><p><strong>l_norm</strong> – if you are using ln_structured you need to specify l_norm.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="quantizationcallback">
<h3><a class="toc-backref" href="#id19">QuantizationCallback</a><a class="headerlink" href="#quantizationcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.quantization.QuantizationCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.quantization.</code><code class="sig-name descname">QuantizationCallback</code><span class="sig-paren">(</span><em class="sig-param">logdir: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">filename: str = 'quantized.pth'</em>, <em class="sig-param">qconfig_spec: Dict = None</em>, <em class="sig-param">dtype: Union[str</em>, <em class="sig-param">torch.dtype</em>, <em class="sig-param">None] = 'qint8'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/quantization.html#QuantizationCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.quantization.QuantizationCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback for model quantiztion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logdir</strong> – path to folder for saving</p></li>
<li><p><strong>filename</strong> – filename</p></li>
<li><p><strong>qconfig_spec</strong> (<em>Dict</em><em>, </em><em>optional</em>) – quantization config in PyTorch format.
Defaults to None.</p></li>
<li><p><strong>dtype</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Optional</em><em>[</em><em>torch.dtype</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Type of weights after quantization.
Defaults to “qint8”.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>

<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">dl</span>
<span class="kn">from</span> <span class="nn">catalyst.data.transforms</span> <span class="kn">import</span> <span class="n">ToTensor</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.datasets</span> <span class="kn">import</span> <span class="n">MNIST</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.nn.modules</span> <span class="kn">import</span> <span class="n">Flatten</span>

<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">MNIST</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span>
        <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">MNIST</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span>
        <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">Flatten</span><span class="p">(),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">dl</span><span class="o">.</span><span class="n">QuantizationCallback</span><span class="p">(</span><span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logs&quot;</span><span class="p">)],</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logs&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="scheduler-schedulercallback">
<h3><a class="toc-backref" href="#id20">Scheduler – SchedulerCallback</a><a class="headerlink" href="#scheduler-schedulercallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.scheduler.SchedulerCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.scheduler.</code><code class="sig-name descname">SchedulerCallback</code><span class="sig-paren">(</span><em class="sig-param">scheduler_key: str = None</em>, <em class="sig-param">mode: str = None</em>, <em class="sig-param">loader_key: str = None</em>, <em class="sig-param">metric_key: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#SchedulerCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.SchedulerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.scheduler.ISchedulerCallback</span></code></p>
<p>Scheduler callback, abstraction over scheduler step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scheduler_key</strong> – scheduler name, if <code class="docutils literal notranslate"><span class="pre">None</span></code>,
default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>mode</strong> – scheduler mode, should be one of
<code class="docutils literal notranslate"><span class="pre">&quot;epoch&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;batch&quot;</span></code>, default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> and object is instance of <code class="docutils literal notranslate"><span class="pre">BatchScheduler</span></code>
or <code class="docutils literal notranslate"><span class="pre">OneCycleLRWithWarmup</span></code> then will be used <code class="docutils literal notranslate"><span class="pre">&quot;batch&quot;</span></code>
otherwise - <code class="docutils literal notranslate"><span class="pre">&quot;epoch&quot;</span></code>.</p></li>
<li><p><strong>loader_key</strong> – &#64;TODO: docs.</p></li>
<li><p><strong>metric_key</strong> – metric name to forward to scheduler
object, if <code class="docutils literal notranslate"><span class="pre">None</span></code> then will be used main metric
specified in experiment.</p></li>
</ul>
</dd>
</dl>
<p>Notebook API example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>
<span class="kn">from</span> <span class="nn">catalyst.dl</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SupervisedRunner</span><span class="p">,</span> <span class="n">AccuracyCallback</span><span class="p">,</span>
    <span class="n">CriterionCallback</span><span class="p">,</span> <span class="n">SchedulerCallback</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span> <span class="o">=</span> <span class="mi">10_000</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">n_classes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_features</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">,</span> <span class="p">[</span><span class="n">num_samples</span><span class="p">])</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">TensorDataset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">loader</span><span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">MultiStepLR</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logdir&quot;</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">valid_metric</span><span class="o">=</span><span class="s2">&quot;accuracy03&quot;</span><span class="p">,</span>
    <span class="n">minimize_metric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
        <span class="n">AccuracyCallback</span><span class="p">(</span>
            <span class="n">accuracy_args</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="p">),</span>
        <span class="n">SchedulerCallback</span><span class="p">(</span><span class="n">reduced_metric</span><span class="o">=</span><span class="s2">&quot;loss&quot;</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Config API usage example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">stages</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="l l-Scalar l-Scalar-Plain">scheduler_params</span><span class="p p-Indicator">:</span>
    <span class="nt">scheduler</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MultiStepLR</span>
    <span class="nt">milestones</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">]</span>
    <span class="nt">gamma</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.3</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="nt">stage_N</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
    <span class="l l-Scalar l-Scalar-Plain">callbacks_params</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">...</span>
      <span class="l l-Scalar l-Scalar-Plain">scheduler</span><span class="p p-Indicator">:</span>
        <span class="nt">callback</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SchedulerCallback</span>
        <span class="c1"># arguments for SchedulerCallback</span>
        <span class="nt">reduced_metric</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">loss</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<dl class="method">
<dt id="catalyst.callbacks.scheduler.SchedulerCallback.make_batch_step">
<code class="sig-name descname">make_batch_step</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#SchedulerCallback.make_batch_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.SchedulerCallback.make_batch_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform scheduler step and update batch metrics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.SchedulerCallback.make_epoch_step">
<code class="sig-name descname">make_epoch_step</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#SchedulerCallback.make_epoch_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.SchedulerCallback.make_epoch_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform scheduler step and update epoch metrics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>runner</strong> – current runner</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="scheduler-lrfinder">
<h3><a class="toc-backref" href="#id21">Scheduler – LRFinder</a><a class="headerlink" href="#scheduler-lrfinder" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.scheduler.LRFinder">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.scheduler.</code><code class="sig-name descname">LRFinder</code><span class="sig-paren">(</span><em class="sig-param">final_lr: float</em>, <em class="sig-param">scale: str = 'log'</em>, <em class="sig-param">num_steps: Optional[int] = None</em>, <em class="sig-param">optimizer_key: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#LRFinder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.LRFinder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.scheduler.ILRUpdater</span></code></p>
<p>Helps you find an optimal learning rate for a model, as per suggestion of
<a class="reference external" href="https://arxiv.org/abs/1506.01186">Cyclical Learning Rates for Training Neural Networks</a> paper.
Learning rate is increased in linear or log scale, depending on user input.</p>
<p>See <a class="reference external" href="https://sgugger.github.io/how-do-you-find-a-good-learning-rate.html">How Do You Find A Good Learning Rate</a> article for details.</p>
<dl class="method">
<dt id="catalyst.callbacks.scheduler.LRFinder.calc_lr">
<code class="sig-name descname">calc_lr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#LRFinder.calc_lr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.LRFinder.calc_lr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates learning rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>learning rate.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="catalyst.callbacks.scheduler.LRFinder.calc_momentum">
<code class="sig-name descname">calc_momentum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/scheduler.html#LRFinder.calc_momentum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.scheduler.LRFinder.calc_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates new momentum.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="tracing">
<h3><a class="toc-backref" href="#id22">Tracing</a><a class="headerlink" href="#tracing" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.tracing.TracingCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.tracing.</code><code class="sig-name descname">TracingCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: Union[str, List[str]], logdir: Union[str, pathlib.Path] = None, filename: str = 'traced_model.pth', method_name: str = 'forward'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/tracing.html#TracingCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.tracing.TracingCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback for model tracing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key from <code class="docutils literal notranslate"><span class="pre">runner.batch</span></code> to use for model tracing</p></li>
<li><p><strong>logdir</strong> – path to folder for saving</p></li>
<li><p><strong>filename</strong> – filename</p></li>
<li><p><strong>method_name</strong> – Model’s method name that will be used as entrypoint during tracing</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>

<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">dl</span>
<span class="kn">from</span> <span class="nn">catalyst.data.transforms</span> <span class="kn">import</span> <span class="n">ToTensor</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.datasets</span> <span class="kn">import</span> <span class="n">MNIST</span>
<span class="kn">from</span> <span class="nn">catalyst.contrib.nn.modules</span> <span class="kn">import</span> <span class="n">Flatten</span>

<span class="n">loaders</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">MNIST</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()</span>
        <span class="p">),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s2">&quot;valid&quot;</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">MNIST</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">()</span>
        <span class="p">),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">Flatten</span><span class="p">(),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">SupervisedRunner</span><span class="p">()</span>
<span class="n">runner</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">dl</span><span class="o">.</span><span class="n">TracingCallback</span><span class="p">(</span><span class="n">input_key</span><span class="o">=</span><span class="s2">&quot;features&quot;</span><span class="p">,</span> <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logs&quot;</span><span class="p">)],</span>
    <span class="n">loaders</span><span class="o">=</span><span class="n">loaders</span><span class="p">,</span>
    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">num_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">logdir</span><span class="o">=</span><span class="s2">&quot;./logs&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="module-catalyst.callbacks.metrics">
<span id="metric"></span><h2><a class="toc-backref" href="#id23">Metric</a><a class="headerlink" href="#module-catalyst.callbacks.metrics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="accuracy-accuracycallback">
<h3><a class="toc-backref" href="#id24">Accuracy - AccuracyCallback</a><a class="headerlink" href="#accuracy-accuracycallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.accuracy.AccuracyCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.accuracy.</code><code class="sig-name descname">AccuracyCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">topk_args: List[int] = None</em>, <em class="sig-param">num_classes: int = None</em>, <em class="sig-param">log_on_batch: bool = True</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/accuracy.html#AccuracyCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.accuracy.AccuracyCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Accuracy metric callback.
Computes multiclass <a class="reference external" href="mailto:accuracy&#37;&#52;&#48;topk">accuracy<span>&#64;</span>topk</a> for the specified values of <cite>topk</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>topk_args</strong> – specifies which accuracy&#64;K to log:
[1] - accuracy
[1, 3] - accuracy at 1 and 3
[1, 3, 5] - accuracy at 1, 3 and 5</p></li>
<li><p><strong>num_classes</strong> – number of classes to calculate <code class="docutils literal notranslate"><span class="pre">topk_args</span></code> if <code class="docutils literal notranslate"><span class="pre">accuracy_args</span></code> is None</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="accuracy-multilabelaccuracycallback">
<h3><a class="toc-backref" href="#id25">Accuracy - MultilabelAccuracyCallback</a><a class="headerlink" href="#accuracy-multilabelaccuracycallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.accuracy.MultilabelAccuracyCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.accuracy.</code><code class="sig-name descname">MultilabelAccuracyCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">threshold: Union[float</em>, <em class="sig-param">torch.Tensor] = 0.5</em>, <em class="sig-param">log_on_batch: bool = True</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/accuracy.html#MultilabelAccuracyCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.accuracy.MultilabelAccuracyCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Multilabel accuracy metric callback.
Computes multilabel <a class="reference external" href="mailto:accuracy&#37;&#52;&#48;topk">accuracy<span>&#64;</span>topk</a> for the specified values of <cite>topk</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>threshold</strong> – thresholds for model scores</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="auccallback">
<h3><a class="toc-backref" href="#id26">AUCCallback</a><a class="headerlink" href="#auccallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.auc.AUCCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.auc.</code><code class="sig-name descname">AUCCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/auc.html#AUCCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.auc.AUCCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.LoaderMetricCallback" title="catalyst.callbacks.metric.LoaderMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.LoaderMetricCallback</span></code></a></p>
<p>ROC-AUC  metric callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for auc calculation, specifies our <code class="docutils literal notranslate"><span class="pre">y_true</span></code>.</p></li>
<li><p><strong>target_key</strong> – output key to use for auc calculation, specifies our <code class="docutils literal notranslate"><span class="pre">y_pred</span></code>.</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="classification-precisionrecallf1supportcallback">
<h3><a class="toc-backref" href="#id27">Classification – PrecisionRecallF1SupportCallback</a><a class="headerlink" href="#classification-precisionrecallf1supportcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.classification.PrecisionRecallF1SupportCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.classification.</code><code class="sig-name descname">PrecisionRecallF1SupportCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">num_classes: int</em>, <em class="sig-param">zero_division: int = 0</em>, <em class="sig-param">log_on_batch: bool = True</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/classification.html#PrecisionRecallF1SupportCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.classification.PrecisionRecallF1SupportCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Multiclass PrecisionRecallF1Support metric callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>num_classes</strong> – number of classes</p></li>
<li><p><strong>zero_division</strong> – value to set in case of zero division during metrics
(precision, recall) computation; should be one of 0 or 1</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="classification-multilabelprecisionrecallf1supportcallback">
<h3><a class="toc-backref" href="#id28">Classification – MultilabelPrecisionRecallF1SupportCallback</a><a class="headerlink" href="#classification-multilabelprecisionrecallf1supportcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.classification.MultilabelPrecisionRecallF1SupportCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.classification.</code><code class="sig-name descname">MultilabelPrecisionRecallF1SupportCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">num_classes: int</em>, <em class="sig-param">zero_division: int = 0</em>, <em class="sig-param">log_on_batch: bool = True</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/classification.html#MultilabelPrecisionRecallF1SupportCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.classification.MultilabelPrecisionRecallF1SupportCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Multilabel PrecisionRecallF1Support metric callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>num_classes</strong> – number of classes</p></li>
<li><p><strong>zero_division</strong> – value to set in case of zero division during metrics
(precision, recall) computation; should be one of 0 or 1</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="cmcscorecallback">
<h3><a class="toc-backref" href="#id29">CMCScoreCallback</a><a class="headerlink" href="#cmcscorecallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.cmc_score.CMCScoreCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.cmc_score.</code><code class="sig-name descname">CMCScoreCallback</code><span class="sig-paren">(</span><em class="sig-param">embeddings_key: str</em>, <em class="sig-param">labels_key: str</em>, <em class="sig-param">is_query_key: str</em>, <em class="sig-param">topk_args: List[int] = None</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/cmc_score.html#CMCScoreCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.cmc_score.CMCScoreCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.LoaderMetricCallback" title="catalyst.callbacks.metric.LoaderMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.LoaderMetricCallback</span></code></a></p>
<p>Cumulative Matching Characteristics callback.</p>
<p>This callback was designed to count
cumulative matching characteristics.
If current object is from query your dataset
should output <cite>True</cite> in <cite>is_query_key</cite>
and false if current object is from gallery.
You can see <cite>QueryGalleryDataset</cite> in
<cite>catalyst.contrib.datasets.metric_learning</cite> for more information.
On batch end callback accumulate all embeddings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embeddings_key</strong> – embeddings key in output dict</p></li>
<li><p><strong>labels_key</strong> – labels key in output dict</p></li>
<li><p><strong>is_query_key</strong> – bool key True if current object is from query</p></li>
<li><p><strong>topk_args</strong> – specifies which cmc&#64;K to log.
[1] - cmc&#64;1
[1, 3] - cmc&#64;1 and cmc&#64;3
[1, 3, 5] - cmc&#64;1, cmc&#64;3 and cmc&#64;5</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should use it with <cite>ControlFlowCallback</cite>
and add all query/gallery sets to loaders.
Loaders should contain “is_query” and “label” key.</p>
</div>
<p>An usage example can be found in Readme.md under
“CV - MNIST with Metric Learning”.</p>
</dd></dl>

</div>
<div class="section" id="confusionmatrixcallback">
<h3><a class="toc-backref" href="#id30">ConfusionMatrixCallback</a><a class="headerlink" href="#confusionmatrixcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.confusion_matrix.ConfusionMatrixCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.confusion_matrix.</code><code class="sig-name descname">ConfusionMatrixCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">class_names: List[str] = None</em>, <em class="sig-param">num_classes: int = None</em>, <em class="sig-param">normalized: bool = False</em>, <em class="sig-param">plot_params: Dict = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/confusion_matrix.html#ConfusionMatrixCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.confusion_matrix.ConfusionMatrixCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#catalyst.core.callback.Callback" title="catalyst.core.callback.Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.core.callback.Callback</span></code></a></p>
<p>Callback to plot your confusion matrix to the loggers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – key to use from <code class="docutils literal notranslate"><span class="pre">runner.batch</span></code>, specifies our <code class="docutils literal notranslate"><span class="pre">y_pred</span></code></p></li>
<li><p><strong>target_key</strong> – key to use from <code class="docutils literal notranslate"><span class="pre">runner.batch</span></code>, specifies our <code class="docutils literal notranslate"><span class="pre">y_true</span></code></p></li>
<li><p><strong>prefix</strong> – plot name for monitoring tools</p></li>
<li><p><strong>class_names</strong> – list with class names</p></li>
<li><p><strong>num_classes</strong> – number of classes</p></li>
<li><p><strong>normalized</strong> – boolean flag for confusion matrix normalization</p></li>
<li><p><strong>plot_params</strong> – extra params for plt.figure rendering</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>catalyst[ml] required for this callback</p>
</div>
</dd></dl>

</div>
<div class="section" id="functionalmetriccallback">
<h3><a class="toc-backref" href="#id31">FunctionalMetricCallback</a><a class="headerlink" href="#functionalmetriccallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.functional_metric.FunctionalMetricCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.functional_metric.</code><code class="sig-name descname">FunctionalMetricCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: Union[str, Iterable[str], Dict[str, str]], target_key: Union[str, Iterable[str], Dict[str, str]], metric_fn: Callable, metric_key: str, compute_on_call: bool = True, log_on_batch: bool = True, prefix: str = None, suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/functional_metric.html#FunctionalMetricCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.functional_metric.FunctionalMetricCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.FunctionalBatchMetricCallback</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>metric_fn</strong> – metric function, that get outputs, targets and return score as torch.Tensor</p></li>
<li><p><strong>metric_key</strong> – key to store computed metric in <code class="docutils literal notranslate"><span class="pre">runner.batch_metrics</span></code> dictionary</p></li>
<li><p><strong>compute_on_call</strong> – Computes and returns metric value during metric call.
Used for per-batch logging. default: True</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="recsys-hitratecallback">
<h3><a class="toc-backref" href="#id32">RecSys – HitrateCallback</a><a class="headerlink" href="#recsys-hitratecallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.recsys.HitrateCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.recsys.</code><code class="sig-name descname">HitrateCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">topk_args: List[int] = None</em>, <em class="sig-param">log_on_batch: bool = True</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/recsys.html#HitrateCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.recsys.HitrateCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Hitrate metric callback.
Computes  <a class="reference external" href="mailto:HR&#37;&#52;&#48;topk">HR<span>&#64;</span>topk</a> for the specified values of <cite>topk</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>topk_args</strong> – specifies which HR&#64;K to log:
[1] - HR
[1, 3] - HR at 1 and 3
[1, 3, 5] - HR at 1, 3 and 5</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="recsys-mapcallback">
<h3><a class="toc-backref" href="#id33">RecSys – MAPCallback</a><a class="headerlink" href="#recsys-mapcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.recsys.MAPCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.recsys.</code><code class="sig-name descname">MAPCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">topk_args: List[int] = None</em>, <em class="sig-param">log_on_batch: bool = True</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/recsys.html#MAPCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.recsys.MAPCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>MAP metric callback.
Computes  <a class="reference external" href="mailto:MAP&#37;&#52;&#48;topk">MAP<span>&#64;</span>topk</a> for the specified values of <cite>topk</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>prefix</strong> – key for the metric’s name</p></li>
<li><p><strong>topk_args</strong> – specifies which MAP&#64;K to log:
[1] - MAP
[1, 3] - MAP at 1 and 3
[1, 3, 5] - MAP at 1, 3 and 5</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="recsys-mrrcallback">
<h3><a class="toc-backref" href="#id34">RecSys – MRRCallback</a><a class="headerlink" href="#recsys-mrrcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.recsys.MRRCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.recsys.</code><code class="sig-name descname">MRRCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">topk_args: List[int] = None</em>, <em class="sig-param">log_on_batch: bool = True</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/recsys.html#MRRCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.recsys.MRRCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>MRR metric callback.
Computes  <a class="reference external" href="mailto:MRR&#37;&#52;&#48;topk">MRR<span>&#64;</span>topk</a> for the specified values of <cite>topk</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>prefix</strong> – key for the metric’s name</p></li>
<li><p><strong>topk_args</strong> – specifies which MRR&#64;K to log:
[1] - MRR
[1, 3] - MRR at 1 and 3
[1, 3, 5] - MRR at 1, 3 and 5</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="recsys-ndcgcallback">
<h3><a class="toc-backref" href="#id35">RecSys – NDCGCallback</a><a class="headerlink" href="#recsys-ndcgcallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.recsys.NDCGCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.recsys.</code><code class="sig-name descname">NDCGCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">topk_args: List[int] = None</em>, <em class="sig-param">log_on_batch: bool = True</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/recsys.html#NDCGCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.recsys.NDCGCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>NDCG metric callback.
Computes  <a class="reference external" href="mailto:NDCG&#37;&#52;&#48;topk">NDCG<span>&#64;</span>topk</a> for the specified values of <cite>topk</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>prefix</strong> – key for the metric’s name</p></li>
<li><p><strong>topk_args</strong> – specifies which NDCG&#64;K to log:
[1] - NDCG
[1, 3] - NDCG at 1 and 3
[1, 3, 5] - NDCG at 1, 3 and 5</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="segmentation-dicecallback">
<h3><a class="toc-backref" href="#id36">Segmentation – DiceCallback</a><a class="headerlink" href="#segmentation-dicecallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.segmentation.DiceCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.segmentation.</code><code class="sig-name descname">DiceCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">class_dim: int = 1</em>, <em class="sig-param">weights: Optional[List[float]] = None</em>, <em class="sig-param">class_names: Optional[List[str]] = None</em>, <em class="sig-param">threshold: Optional[float] = None</em>, <em class="sig-param">log_on_batch: bool = True</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/segmentation.html#DiceCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.segmentation.DiceCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Dice metric callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>class_dim</strong> – &#64;TODO: docs</p></li>
<li><p><strong>weights</strong> – &#64;TODO: docs</p></li>
<li><p><strong>class_names</strong> – &#64;TODO: docs</p></li>
<li><p><strong>threshold</strong> – &#64;TODO: docs</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="segmentation-ioucallback">
<h3><a class="toc-backref" href="#id37">Segmentation – IOUCallback</a><a class="headerlink" href="#segmentation-ioucallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.segmentation.IOUCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.segmentation.</code><code class="sig-name descname">IOUCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">class_dim: int = 1</em>, <em class="sig-param">weights: Optional[List[float]] = None</em>, <em class="sig-param">class_names: Optional[List[str]] = None</em>, <em class="sig-param">threshold: Optional[float] = None</em>, <em class="sig-param">log_on_batch: bool = True</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/segmentation.html#IOUCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.segmentation.IOUCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>IOU metric callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>class_dim</strong> – &#64;TODO: docs</p></li>
<li><p><strong>weights</strong> – &#64;TODO: docs</p></li>
<li><p><strong>class_names</strong> – &#64;TODO: docs</p></li>
<li><p><strong>threshold</strong> – &#64;TODO: docs</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="segmentation-trevskycallback">
<h3><a class="toc-backref" href="#id38">Segmentation – TrevskyCallback</a><a class="headerlink" href="#segmentation-trevskycallback" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="catalyst.callbacks.metrics.segmentation.TrevskyCallback">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.callbacks.metrics.segmentation.</code><code class="sig-name descname">TrevskyCallback</code><span class="sig-paren">(</span><em class="sig-param">input_key: str</em>, <em class="sig-param">target_key: str</em>, <em class="sig-param">alpha: float</em>, <em class="sig-param">beta: Optional[float] = None</em>, <em class="sig-param">class_dim: int = 1</em>, <em class="sig-param">weights: Optional[List[float]] = None</em>, <em class="sig-param">class_names: Optional[List[str]] = None</em>, <em class="sig-param">threshold: Optional[float] = None</em>, <em class="sig-param">log_on_batch: bool = True</em>, <em class="sig-param">prefix: str = None</em>, <em class="sig-param">suffix: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/callbacks/metrics/segmentation.html#TrevskyCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.callbacks.metrics.segmentation.TrevskyCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#catalyst.callbacks.metric.BatchMetricCallback" title="catalyst.callbacks.metric.BatchMetricCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.callbacks.metric.BatchMetricCallback</span></code></a></p>
<p>Trevsky metric callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> – input key to use for metric calculation, specifies our <cite>y_pred</cite></p></li>
<li><p><strong>target_key</strong> – output key to use for metric calculation, specifies our <cite>y_true</cite></p></li>
<li><p><strong>class_dim</strong> – &#64;TODO: docs</p></li>
<li><p><strong>weights</strong> – &#64;TODO: docs</p></li>
<li><p><strong>class_names</strong> – &#64;TODO: docs</p></li>
<li><p><strong>threshold</strong> – &#64;TODO: docs</p></li>
<li><p><strong>log_on_batch</strong> – boolean flag to log computed metrics every batch</p></li>
<li><p><strong>prefix</strong> – metric prefix</p></li>
<li><p><strong>suffix</strong> – metric suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contrib.html" class="btn btn-neutral float-right" title="Contrib" accesskey="n" rel="next">Next <img src="../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="../faq/config_api.html" class="btn btn-neutral" title="Config API" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Scitator.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="catalyst-content-right" id="catalyst-content-right">
          <div class="catalyst-right-menu" id="catalyst-right-menu">
            <div class="catalyst-side-scroll" id="catalyst-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Callbacks</a><ul>
<li><a class="reference internal" href="#module-catalyst.callbacks">Run</a><ul>
<li><a class="reference internal" href="#batchoverfitcallback">BatchOverfitCallback</a></li>
<li><a class="reference internal" href="#batchtransformcallback">BatchTransformCallback</a></li>
<li><a class="reference internal" href="#checkpointcallback">CheckpointCallback</a></li>
<li><a class="reference internal" href="#controlflowcallback">ControlFlowCallback</a></li>
<li><a class="reference internal" href="#criterioncallback">CriterionCallback</a></li>
<li><a class="reference internal" href="#metric-batchmetriccallback">Metric – BatchMetricCallback</a></li>
<li><a class="reference internal" href="#metric-loadermetriccallback">Metric – LoaderMetricCallback</a></li>
<li><a class="reference internal" href="#metric-metricaggregationcallback">Metric – MetricAggregationCallback</a></li>
<li><a class="reference internal" href="#misc-checkruncallback">Misc – CheckRunCallback</a></li>
<li><a class="reference internal" href="#misc-earlystoppingcallback">Misc – EarlyStoppingCallback</a></li>
<li><a class="reference internal" href="#misc-timercallback">Misc – TimerCallback</a></li>
<li><a class="reference internal" href="#misc-tqdmcallback">Misc – TqdmCallback</a></li>
<li><a class="reference internal" href="#onnxcallback">OnnxCallback</a></li>
<li><a class="reference internal" href="#optimizercallback">OptimizerCallback</a></li>
<li><a class="reference internal" href="#optunapruningcallback">OptunaPruningCallback</a></li>
<li><a class="reference internal" href="#periodicloadercallback">PeriodicLoaderCallback</a></li>
<li><a class="reference internal" href="#pruningcallback">PruningCallback</a></li>
<li><a class="reference internal" href="#quantizationcallback">QuantizationCallback</a></li>
<li><a class="reference internal" href="#scheduler-schedulercallback">Scheduler – SchedulerCallback</a></li>
<li><a class="reference internal" href="#scheduler-lrfinder">Scheduler – LRFinder</a></li>
<li><a class="reference internal" href="#tracing">Tracing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-catalyst.callbacks.metrics">Metric</a><ul>
<li><a class="reference internal" href="#accuracy-accuracycallback">Accuracy - AccuracyCallback</a></li>
<li><a class="reference internal" href="#accuracy-multilabelaccuracycallback">Accuracy - MultilabelAccuracyCallback</a></li>
<li><a class="reference internal" href="#auccallback">AUCCallback</a></li>
<li><a class="reference internal" href="#classification-precisionrecallf1supportcallback">Classification – PrecisionRecallF1SupportCallback</a></li>
<li><a class="reference internal" href="#classification-multilabelprecisionrecallf1supportcallback">Classification – MultilabelPrecisionRecallF1SupportCallback</a></li>
<li><a class="reference internal" href="#cmcscorecallback">CMCScoreCallback</a></li>
<li><a class="reference internal" href="#confusionmatrixcallback">ConfusionMatrixCallback</a></li>
<li><a class="reference internal" href="#functionalmetriccallback">FunctionalMetricCallback</a></li>
<li><a class="reference internal" href="#recsys-hitratecallback">RecSys – HitrateCallback</a></li>
<li><a class="reference internal" href="#recsys-mapcallback">RecSys – MAPCallback</a></li>
<li><a class="reference internal" href="#recsys-mrrcallback">RecSys – MRRCallback</a></li>
<li><a class="reference internal" href="#recsys-ndcgcallback">RecSys – NDCGCallback</a></li>
<li><a class="reference internal" href="#segmentation-dicecallback">Segmentation – DiceCallback</a></li>
<li><a class="reference internal" href="#segmentation-ioucallback">Segmentation – IOUCallback</a></li>
<li><a class="reference internal" href="#segmentation-trevskycallback">Segmentation – TrevskyCallback</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script type="text/javascript" src="../_static/jquery.js"></script>
         <script type="text/javascript" src="../_static/underscore.js"></script>
         <script type="text/javascript" src="../_static/doctools.js"></script>
         <script type="text/javascript" src="../_static/language_data.js"></script>
         <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <footer class="site-footer" id="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://catalyst-team.com/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://github.com/catalyst-team">Ecosystem</a></li>
            <li><a class="nav-dropdown-item" href="https://alchemy.host">Alchemy</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/catalyst">Catalyst</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/reaction">Reaction</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://github.com/catalyst-team">Projects</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/codestyle">Codestyle</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/neuro">Catalyst.Neuro</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/classification">Classification</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/detection">Detection</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/segmentation">Segmentation</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/gan">Catalyst.GAN</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://catalyst-team.com/">Support</a></li>
            <li><a href="https://github.com/catalyst-team/catalyst/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://github.com/catalyst-team/catalyst/blob/master/CONTRIBUTING.md" target="_blank">Contributing</a></li>
            <li><a href="https://www.patreon.com/catalyst_team" target="_blank">Patreon</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <div class="footer-social-icons">
            <a href="https://t.me/catalyst_team" target="_blank" class="telegram"></a>
            <a href="https://twitter.com/catalyst_core" target="_blank" class="twitter"></a>
            <a href="https://join.slack.com/t/catalyst-team-core/shared_invite/zt-d9miirnn-z86oKDzFMKlMG4fgFdZafw" target="_blank" class="ods"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>


  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://catalyst-team.com/" aria-label="Catalyst"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="">Get Started</a>
          </li>

          <li>
            <a href="https://github.com/catalyst-team/catalyst">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      catalystAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.catalyst-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>